# 项目笔记2_6

#### springMvc接受处理请求流程

- dispatcherServlet：可以处理所有的非jsp的请求
  1. 将springmvc扫描到的所有的controller的requestMapping映射封装成handler对象（每个handler队形都有：映射地址、请求参数列表、请求方式）
  2. dispatcherServlet接收到请求转为请求对象（这个对象有自己的：请求地址、请求方式、请求参数）
  3. dispatcherServlet根据请求方法去查找处理本次请求的controller方法
     1. 首先使用提交请求的路径 和 handler对象集合中的所有handler进行比较，判断有没有地址可以匹配本次请求
        - 如果匹配不成功，返回404
        - 如果匹配到了handler，使用匹配到的handler集合所有handler的请求方式和本次请求方式进行比较
          - 如果匹配失败返回405（请求不被支持，后端对应的请求地址的handler要求的请求方式和当前你发使用的请求不一致）
          - 如果匹配到了handler（证明匹配地址和请求方式都相同）在根据handler方法的参数列表获取请求对象中的请求参数入参
            - 如果handler方法必须要求的参数和我们所传入的不一样返回400（传入的请求参数和后端的要求传入的参数不一致）
          - 如果全部匹配成功，dispatcherServlet调用handler方法处理本次请求

> **当前存在跨域时：客户端服务器提交的请求在服务器端中没有匹配到处理请求的controller方法，同源策略会认为你本次请求跨域了**

#### 常见的错误排查步骤：

错误排查：
	1、必须搞清楚，请求从开始提交到后端处理请求时业务流程
	再从前到后排查
	2、查看绑定事件的函数是否调用
	3、查看前端api提交请求的方法：请求地址，配置参数属性名属性值是否写错、请求方式、请求参数传递方式
	4、检查后端是否接受到本次请求
	5、检查参数是否接受正确
	6、检查业务层业务逻辑错误
	7、mapper如果是自定义sql，检查sql是否正确

#### 分布式

**web系统中：网络请求发送时需要遵循HTTP协议**
**springcloud微服务远程访问时，基于 HTTP+JSON**

#### 微服务启动常见错误

微服务启动报错：

```txt
1、项目的依赖环境有错(删库重新下载或者  换一个版本的依赖)
一般是网络较差时遇到
2、Failed to configure a DataSource: 'url' (其他也有类似的错误)
springboot自动配置和自动依赖
	- springboot将 一组依赖都引入到一个maven项目中当成一个场景，如果某个项目依赖了maven项目，也会得到整个场景其他的所有依赖
	- springboot创建项目时会自动引入autoconfigure依赖
		依赖中保存了一个自动配置的文件，springboot项目启动时会自动扫描该文件根据当前的环境自动初始化配置对象存到spring容器中

		如果springboot项目引入了数据库的依赖，但是没有在配置文件中配置数据库连接池参数，项目启动时默认需要创建数据库连接池配置类对象
		解决：
			方式1：在配置文件中配置数据库连接
			方式2：由于oss不需要使用数据库连接
				可以在启动类上指定不初始化数据库连接池的配置类对象
```