# 项目笔记2_14

### 登陆时cookie和session

![image-20210222144703591](typora-user-images\image-20210222144703591.png)

### jwt

json web token的缩写，是一种自包含令牌，用作在浏览器端存储登陆用户的信息

**访问令牌类型**

![image-20210222150543723](typora-user-images\image-20210222150543723.png)

- **JWT的使用场景：**
  - 一种情况是webapi，类似之前的阿里云播放凭证的功能
  - 另一种情况是多web服务器下实现无状态分布式身份验证
- **JWT的作用：**
  - JWT 最重要的作用就是对 token信息的防伪作用
- **JWT的原理：**
  - 一个JWT由三个部分组成：JWT头、有效载荷、签名哈希最后由这三者组合进行base64编码得到JWT

![image-20210222145408335](typora-user-images\image-20210222145408335.png)
	

```txt
jwt是不是单点登录实现方式，不是

  cas单点登录： 后端保存登录状态
	分布式系统中只有认证中心提供登录公共，其他的微服务需要登录时都通过该服务实现登录
	
	A:认证服务
	B：功能1服务
	C：功能2服务
	用户访问B服务时的操作如果需要登录，B服务给浏览器一个重定向响应：地址为A的地址在地址后拼接url=B登录成功的跳转地址
	用户访问重定向的A的登录页面提交登录请求，A服务处理登录成功后(将登录信息存到redis中)会再给浏览器一个重定向响应，地址为上一步接受到的B的地址
	用户在访问B的时候如果需要检查登录状态，可以根据请求报文中携带的key去redis中获取登录信息
    token模式：前端保存登录信息
	jwt是token的一种格式
	用户访问B服务如果需要登录，可以让浏览器跳转到A服务的登录页面，浏览器提交登录请求，如果登录成功
	A服务将登录成功的用户信息封装为token字符串响应给浏览器
	浏览器缓存token
	浏览器再访问分布式的其他微服务时会自动携带token，所有的微服务都可以通过验证token去判断用户身份，获取用户信息

	token的格式分为两种：
		自包含token：jwt (字符串中包含用户信息)
		透明token： 字符串是加密字符串[拦截后不能被破解]
```